{{/* metadata for an Azure HTTP Trigger prometheus */}}
{{- define "function.prometheus" }}
- type: prometheus
  metadata:
    serverAddress: {{ .url }}
    metricName: {{ default "\"access_frequency\"" .metricName }}
    threshold: {{ default "\"1\"" .threshold }} #Since the threshold is '1' the function app will scale as long as the number of requests/minute > 60.
    query: sum(rate(http_requests[{{ default "\"1m\"" .requestsPer }}]))
{{- end }}